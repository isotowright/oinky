<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Oinky</title>

<script type="text/javascript" src="https://cloud.smartables.io/webSocketClient.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.12.1/TweenMax.min.js"></script>
<script src="javascript/main.js"></script>

<script type="text/javascript">

//setTimeout(function(){ alert("Hello"); }, 3000);
var donation = 0;
// Setup your personal infos here:
var API_ID = 'O6vnBwxFTg',
API_SECRET = 'PEU664HSW6',
BOARD_ID = 'A5GK5I4VJQ';
// Start new websocket istance.
var client = new Messaging.Client("cloud.smartables.io", 8001, RandomClientId());
console.log("Client instantiated.");
client.startTrace();
console.log("Now trying to connect...");
client.qos = 0;
client.connect({
useSSL: true,
userName: API_ID,
password: API_SECRET,
onSuccess: onSuccess,
onFailure: onFailure,
timeout:10
});
// Function to trigger connection success.
// Do the main JOBs here!
function onSuccess() {
console.log("connection established");
// Sample code for subscribe a specific topic.
//client.subscribe(API_ID+'/'+BOARD_ID+'/SENSE/2');
// the accel
client.subscribe(API_ID+'/'+BOARD_ID+'/SENSE/10_1');
client.subscribe(API_ID+'/'+BOARD_ID+'/SENSE/1');
//curl -k -X PUT --data '{"rgb":[1,199,50,167]}' --header "X-APISecret: PEU664HSW6" -H "Content-Type: application/json" "https://cloud.smartables.io/api/write/O6vnBwxFTg/A5GK5I4VJQ/ACT/1"
// Sample code to emit a websocket message.
//var message = new Messaging.Message(JSON.stringify({
//"rgb":[1,245,10,174]
//}));
//message.destinationName = API_ID+'/'+BOARD_ID+'/ACT/1 ';
//message.qos = 2;
//message.retained = true;
//client.send(message);
}
// Attach a function when a new message is received.
client.onMessageArrived = function(message) {
//alert('ddd');
console.log(message.payloadString);
var obj = $.parseJSON(message.payloadString);
console.log(obj);
if (obj.single_tap == 1)
{
//$('#accel').text('Single tap');

var message = new Messaging.Message(JSON.stringify({
"rgb":[1,200,200,209]
}));
message.destinationName = API_ID+'/'+BOARD_ID+'/ACT/1 ';
message.qos = 2;
message.retained = true;
client.send(message);

}

if (obj.double_tap == 1)
{
donation++;
monies = donation;
$('#anount').text('Â£'+monies);
//$('#accel').text('Double tap');
//console.log($('#accel').text('Double tap'));
 jQuery('#player').get(0).play();
 
  jQuery('#player').get(0).stop();
//curl -k -X PUT --data '{"rgb":[1,31,61,209]}' --header "X-APISecret: PEU664HSW6" -H "Content-Type: application/json" "https://cloud.smartables.io/api/write/O6vnBwxFTg/A5GK5I4VJQ/ACT/1"

var message = new Messaging.Message(JSON.stringify({
"rgb":[1,31,61,209]
}));
message.destinationName = API_ID+'/'+BOARD_ID+'/ACT/1 ';
message.qos = 2;
message.retained = true;
client.send(message);
}


//
//if (message.payloadString == '{"dig":0}')
//{
// $('#switch').text('Switch is off');
//curl -k -X PUT --data '{"rgb":[1,26,5,19]}' --header "X-APISecret: PEU664HSW6" -H "Content-Type: application/json" "https://cloud.smartables.io/api/
//alert('switch off');
//console.log("switch on");
// message.destinationName = API_ID+'/'+BOARD_ID+'/ACT/3';
//message.qos = 2;
//message.retained = true;
//client.send(message);
//}
}
// Function to trigger connection error.
function onFailure() {
console.log("connection failure");
}
// Attach a function when connection lost.
client.onConnectionLost = function() {
console.log("connection lost");
}
</script>

<link href='http://fonts.googleapis.com/css?family=Roboto:300' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="css/main.css" type="text/css" />

<!--[if IE]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
<!--[if lte IE 7]>
<script src="js/IE8.js" type="text/javascript"></script><![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" type="text/css" media="all" href="css/ie6.css"/><![endif]-->
</head>
<body id="index" class="home">
<div id="switch"></div>
<div id="accel"></div>

<div class="container">

<svg version="1.1"  class="" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
	 x="0px" y="0px" width="409.48px" height="311px" viewBox="0 0 409.48 311" xml:space="preserve">

<path fill="#e74c3c" d="M0,0v311h409.48V0H0z M352.409,197.224c-6.515,11.779-15.29,21.742-25.287,30.707
	c-14.452,12.959-23.149,28.96-25.195,48.415c-0.89,8.464-1.867,16.666-2.889,25.738c-2.554,0-31.06,0.161-31.06,0.161
	c-1.835-0.05-2.112-1.026-3.368-2.35c-8.713-9.188-13.212-24.639-15.734-27.946c-1.8-1.999-3.664-2.503-6.27-2.429
	c-14.092,0.4-47.189,0.688-61.286,0.756c-2.743,0.013-4.307,0.729-5.731,3.072c-6.017,9.905-8.198,19.712-14.418,29.491
	c-0.699,1.1-2.015,2.547-3.068,2.567c-10.376,0.192-20.757,0.116-30.769,0.116c-1.755-9.937-3.52-19.476-5.108-29.045
	c-1.819-10.959-6.427-20.521-14.004-28.621c-1.525-1.63-3.203-3.223-5.083-4.398c-16.834-10.521-30.653-24.008-42.474-40.03
	c-7.387-10.012-17.194-17.731-30.579-19.156c-8.693-0.926-11.971-4.986-11.981-13.855c-0.019-16.531,0.003-33.062-0.009-49.593
	c-0.007-10.202,2.072-12.559,12.188-12.865c8.743-0.265,16.859-2.3,24.057-7.397c1.165-0.825,2.387-1.803,3.097-3
	c10.837-18.266,20.683-32.546,38.432-43.972c0.548-0.353,1.033-0.802,1.841-1.438c-5.591-11.606-16.544-28.214-20.426-38.857
	c10.307-4.482,20.848-6.55,31.902-6.457c9.73,0.082,19.1,1.926,26.486,8.352c4.701,4.09,8.59,8.451,11.787,13.865
	c3.445,7.749,6.88,3.367,20.283,0.351c44.293-9.967,86.633-3.88,126.97,16.137c24.469,12.143,44.66,24.545,58.321,48.585
	c7.714,13.574,11.979,26.87,11.979,49.017C365.01,172.515,354.6,193.262,352.409,197.224z"/>
</svg>


 <div class="saving-bar">
      <div class="loading shadow"></div>
  </div>

<div class="counter"></div>



<div id="">
<audio id="player" preload="auto" autobuffer> <source src="mario.mp3" /></audio>
</div>
</body>
</html>
